{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Tasks{% endblock %}</h1>
  {% if g.user %}
    <a class="action" href="{{ url_for('task_list.create') }}">New</a>
  {% endif %}
{% endblock %}

{% block content %}
  console.log("html - Rendering task list");
  console.log("html - Number of tasks: {{ tasks|length }}");
  {%  if tasks %}
  console.log("html - starting iter");
  {% for task in tasks %}
    <article class="task">
      <header>
        <div>
          <h1>{{ task['task_name'] }}</h1>
          <div class="about">by {{ task['username'] }} on {{ task['create_time'].strftime('%Y-%m-%d') }}</div>
        </div>
        {% if g.user['id'] == task['author_id'] %}
           <form action="{{ url_for('task_list.delete', id=task['id']) }}" method="post">
            <input class="task_complete" type="submit" value="Done">
           </form>
        {% endif %}
      </header>
      <p class="delete_time">{{ task['delete_time'] }}</p>
    </article>
    {% if not loop.last %}
      <hr>
    {% endif %}
  {% endfor %}
  {% endif %}
{% endblock %}